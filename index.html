<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Treino Matemática</title>

<style>
body {
  font-family: Arial, sans-serif;
  text-align: center;
  background: #f4f6f8;
}

h2 {
  margin-top: 20px;
}

button {
  padding: 10px 18px;
  margin: 6px;
  font-size: 15px;
  border-radius: 6px;
  border: none;
  cursor: pointer;
  background: #2d6cdf;
  color: white;
}

button:hover {
  background: #1f4fa8;
}

input {
  padding: 6px;
  margin: 5px;
}

.questao {
  margin: 8px;
  font-size: 18px;
}
</style>
</head>
<body>

<h2>Treino de Matemática</h2>

<!-- NOME PACIENTE -->
<div>
  <input type="text" id="paciente" placeholder="Nome do paciente">
</div>

<hr>

<!-- MENU -->
<div>
  <button onclick="iniciar(['mais'])">n + n</button>
  <button onclick="iniciar(['x2'])">n x 2</button>
  <button onclick="iniciar(['xn'])">n x n</button>
  <button onclick="iniciar(['x5'])">n x 5</button>
  <br>
  <button onclick="iniciar(['mais','x2'])">n+n e n×2</button>
  <button onclick="iniciar(['mais','x2','xn'])">+ , x2 , xn</button>
  <button onclick="iniciar(['mais','x2','xn','x5'])">Todos</button>
</div>

<hr>

<div id="quiz"></div>

<button id="enviarBtn" style="display:none;" onclick="enviar()">Enviar</button>

<script>

// ====== COLE SEU LINK AQUI ======
const URL = "https://script.google.com/macros/s/AKfycbzrKaaK1w5UbLKNRBJ9qwr45HupRSFB2E6ZqfS53lDHihZBzAzOhcI9ZYRQnrLhkHPndA/exec";
// exemplo:
// const URL = "https://script.google.com/macros/s/AKfycbxxxxxxx/exec";
// =================================


// -------- GERAÇÃO --------

function gerarBase(tipo) {
  const contas = [];

  if (tipo === "mais") {
    for (let i = 1; i <= 9; i++) {
      contas.push({pergunta: `${i} + ${i}`, resposta: i + i});
    }
  }

  if (tipo === "x2") {
    for (let i = 1; i <= 9; i++) {
      contas.push({pergunta: `${i} x 2`, resposta: i * 2});
    }
  }

  if (tipo === "xn") {
    for (let i = 1; i <= 9; i++) {
      contas.push({pergunta: `${i} x ${i}`, resposta: i * i});
    }
  }

  if (tipo === "x5") {
    for (let i = 1; i <= 9; i++) {
      contas.push({pergunta: `${i} x 5`, resposta: i * 5});
    }
  }

  return contas;
}

function embaralhar(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function gerarModulo(tipos) {
  let contas = [];

  tipos.forEach(tipo => {
    contas = contas.concat(gerarBase(tipo));
  });

  if (tipos.length === 1) {
    contas = contas.concat(contas);
  }

  return embaralhar(contas);
}

let questoesAtuais = [];

function iniciar(tipos) {
  const quiz = document.getElementById("quiz");
  quiz.innerHTML = "";

  questoesAtuais = gerarModulo(tipos);

  questoesAtuais.forEach((q, index) => {
    const div = document.createElement("div");
    div.className = "questao";
    div.innerHTML = `
      ${index + 1}) ${q.pergunta} =
      <input type="number" id="resposta${index}">
    `;
    quiz.appendChild(div);
  });

  document.getElementById("enviarBtn").style.display = "inline-block";
}


// -------- ENVIO --------

function enviar() {
  const nome = document.getElementById("paciente").value;

  if (!nome) {
    alert("Digite o nome do paciente.");
    return;
  }

  const respostas = questoesAtuais.map((q, i) => {
    const valor = document.getElementById(`resposta${i}`).value;
    return {
      pergunta: q.pergunta,
      correta: q.resposta,
      respostaPaciente: valor
    };
  });

  const dados = {
    paciente: nome,
    dataHora: new Date().toLocaleString(),
    respostas: respostas
  };

  fetch(URL, {
    method: "POST",
    body: JSON.stringify(dados),
    headers: {
      "Content-Type": "application/json"
    }
  })
  .then(res => res.text())
  .then(() => {
    alert("Enviado com sucesso!");
  })
  .catch(() => {
    alert("Erro ao enviar.");
  });
}

</script>

</body>
</html>
